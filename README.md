# diffie-hellman-key-exchange

1. Introduction

In this document, we provide a detailed description of a secure communication system that uses the Diffie-Hellman (DH) key exchange algorithm combined with the Advanced Encryption Standard (AES) symmetric encryption. The solution is implemented in Python and allows two parties to exchange messages securely over a network.

2. Diffie-Hellman Key Exchange Algorithm
The Diffie-Hellman algorithm is a cryptographic protocol that enables two parties to establish a shared secret key over an insecure channel. This shared secret can then be used for secure communication using symmetric encryption. The algorithm is based on the mathematical properties of modular exponentiation.

2.1. Explanation
In the DH algorithm, the two parties (Alice and Bob) agree on two public parameters: a large prime number p and a generator g, where g is a primitive root modulo p. Each party then generates a private key and a public key. The private key is a random number selected from the range [1, p-1], and the public key is calculated as g^private_key mod p. The public keys are exchanged, and both parties compute the shared secret using the other party's public key and their private key: shared_secret = other_public_key^private_key mod p. The resulting shared secret is the same for both parties and can be used as a symmetric encryption key.
 
![image](https://user-images.githubusercontent.com/114414059/235533245-32f40737-c52e-4026-9e5a-c437ed88d354.png)
 
2.2. Implementation
The DH algorithm is implemented in the diffieHellman class. The class initializes the p and g parameters, generates a private key and a public key, and provides a method to compute the shared secret using the other party's public key. The implementation uses Python's built-in pow function for modular exponentiation and the random library for generating random private keys.

![image](https://user-images.githubusercontent.com/114414059/235533415-d4132ed0-66ab-406b-98e4-7b0fc5a483dc.png)
 
3. AES Symmetric Encryption
The Advanced Encryption Standard (AES) is a symmetric encryption algorithm that provides strong security and performance. It operates on fixed-size blocks of data and supports key sizes of 128, 192, or 256 bits.

3.1. Explanation
AES encryption involves several rounds of transformations, including substitution, permutation, and key mixing. The number of rounds depends on the key size: 10 rounds for 128-bit keys, 12 rounds for 192-bit keys, and 14 rounds for 256-bit keys. AES decryption reverses the encryption process by applying the inverse transformations in the reverse order.


3.2. Implementation
We use the PyCryptodome library for AES encryption and decryption. The encrypt and decrypt functions in the code handle the encryption and decryption of messages using AES in Cipher Block Chaining (CBC) mode with a randomly generated initialization vector (IV). The sha256 function is used to derive a 256-bit key from the shared secret generated by the DH algorithm.

![image](https://user-images.githubusercontent.com/114414059/235533441-28a0d52a-0333-4b77-9a52-663f32f404a9.png)

![image](https://user-images.githubusercontent.com/114414059/235533471-818a8dff-2d31-47b7-8b26-68818d0b0def.png)

4. Source Code Description
The source code consists of the following components:
• diffieHellman class: Implements the DH key exchange algorithm.
• sha256 function: Hashes the shared secret to derive an AES key.
• encrypt and decrypt functions: Handle AES encryption and decryption of messages.
• Server and Client classes: Implement networked communication between the two parties using sockets and threads.
• Command-line argument parsing: Provides a simple command-line interface for running the program in server or client mode, and for specifying host, port, and DH parameters.

5. Running Environment
The solution requires Python 3.6 or later and the PyCryptodome library. Install the PyCryptodome library using the following command:
 
6. Configuration Files
There are no configuration files required for this solution. All necessary parameters are provided as command-line arguments when running the script.

7. Demonstration of Operation
Step 1: Run the server
In a terminal, run the following command to start the server:
 python client.py server --host localhost --port 5000
 
Replace client.py with the name of the script file containing the code if needed.

![image](https://user-images.githubusercontent.com/114414059/235533531-109e601b-e75f-4e92-84b5-6d77f34942b7.png)
 
Step 2: Run the client
In another terminal, run the following command to start the client:
 python client.py client --host localhost --port 5000
 
 ![image](https://user-images.githubusercontent.com/114414059/235533553-ba11803d-2a52-4972-95b8-d7a60925b111.png)
 
Step 3: Secure communication
Once the client and server are connected, they will perform the DH key exchange and establish a shared secret. You can now type messages in the client terminal and press Enter to send them. The messages will be encrypted using AES, transmitted securely, decrypted on the server side, and displayed in the server terminal.

The Client part:
 
![image](https://user-images.githubusercontent.com/114414059/235533595-24b3b1bb-ebba-44fd-b11b-bb89bb122b36.png)

The Server part:

![image](https://user-images.githubusercontent.com/114414059/235533613-b6b138b9-fb32-4279-a6f3-5dbedd25ca9c.png)
 
8. Conclusion
This document provides a detailed description of a secure communication system implemented in Python that combines the Diffie-Hellman key exchange algorithm with AES symmetric encryption. The solution allows two parties to exchange messages securely over a network using a client-server model. The implementation adheres to best practices and does not rely on specialized helper functions from third parties for the DH algorithm.

![image](https://user-images.githubusercontent.com/114414059/235533778-76bbaa58-fb45-4e58-88c7-b23d048362ef.png)

![image](https://user-images.githubusercontent.com/114414059/235533793-a61fe78e-8e19-4ba8-993e-e20128ce109d.png)


9. References
1.	Diffie, W., & Hellman, M. (1976). New directions in cryptography. IEEE Transactions on Information Theory, 22(6), 644-654. DOI:10.1109/TIT.1976.1055638 (https://doi.org/10.1109/TIT.1976.1055638)
2.	Daemen, J., & Rijmen, V. (2002). The design of Rijndael: AES - the Advanced Encryption Standard. Springer-Verlag. ISBN: 978-3-540-42580-9 (https://www.springer.com/gp/book/9783540425809)
3.	Python Software Foundation. (2021). The Python Language Reference. https://docs.python.org/3/reference/index.html
4.	PyCryptodome. (2021). PyCryptodome: A self-contained cryptographic library for Python. https://www.pycryptodome.org/en/latest/

